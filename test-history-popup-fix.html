<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†å²è®°å½•å¼¹çª—ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        h2 {
            color: #007bff;
            margin-bottom: 15px;
        }
        
        .fix-summary {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .fix-summary h3 {
            color: #155724;
            margin-top: 0;
        }
        
        .test-steps {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .code-block {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .fix-item {
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 4px;
            border-left: 3px solid #28a745;
        }
        
        .problem {
            color: #dc3545;
            font-weight: bold;
        }
        
        .solution {
            color: #28a745;
            font-weight: bold;
        }
        
        ol {
            padding-left: 20px;
        }
        
        li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ LinuxDo Scripts - å†å²è®°å½•å¼¹çª—ä¿®å¤æŠ¥å‘Š</h1>
        
        <div class="fix-summary">
            <h3>âœ… ä¿®å¤æ¦‚è¿°</h3>
            <p>æˆåŠŸè§£å†³äº†å†å²è®°å½•å¼¹çª—æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ï¼Œé€šè¿‡å¤šé‡ä¿éšœæœºåˆ¶ç¡®ä¿å¼¹çª—åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚</p>
        </div>
        
        <div class="test-section">
            <h2>ğŸ› åŸé—®é¢˜åˆ†æ</h2>
            <div class="fix-item">
                <div class="problem">é—®é¢˜1: ä½ç½®è®¡ç®—é”™è¯¯</div>
                <p>å¼¹çª—è¢«å®šä½åˆ° <code>(1142.75, 844.25)</code>ï¼Œå¯èƒ½è¶…å‡ºè§†çª—èŒƒå›´å¯¼è‡´ä¸å¯è§</p>
            </div>
            <div class="fix-item">
                <div class="problem">é—®é¢˜2: CSSç‰¹å¼‚æ€§å†²çª</div>
                <p>æµè§ˆå™¨æ‰©å±•ç¯å¢ƒä¸­å­˜åœ¨CSSæ ·å¼å†²çªï¼Œå¯¼è‡´å¼¹çª—æ ·å¼è¢«è¦†ç›–</p>
            </div>
            <div class="fix-item">
                <div class="problem">é—®é¢˜3: Vueå“åº”æ€§é—®é¢˜</div>
                <p><code>v-show</code> æŒ‡ä»¤å¯èƒ½æ²¡æœ‰æ­£ç¡®å·¥ä½œï¼Œå¯¼è‡´å¼¹çª—æ— æ³•æ˜¾ç¤º</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ</h2>
            
            <div class="fix-item">
                <div class="solution">æ–¹æ¡ˆ1: å®‰å…¨ä½ç½®è®¡ç®—</div>
                <div class="code-block">
// ä¼˜å…ˆä½¿ç”¨å±å¹•ä¸­å¿ƒä½ç½®ï¼Œç¡®ä¿å®Œå…¨å¯è§
let left = (window.innerWidth - popupWidth) / 2
let top = (window.innerHeight - popupHeight) / 2

// ç¡®ä¿åœ¨è§†çª—å†…ï¼Œæ·»åŠ æœ€å°è¾¹è·ä¿æŠ¤
left = Math.max(margin, Math.min(left, window.innerWidth - popupWidth - margin))
top = Math.max(margin, Math.min(top, window.innerHeight - popupHeight - margin))
                </div>
            </div>
            
            <div class="fix-item">
                <div class="solution">æ–¹æ¡ˆ2: æœ€é«˜ä¼˜å…ˆçº§CSSæ ·å¼</div>
                <div class="code-block">
.history-popup-force {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  z-index: 2147483647 !important; /* æœ€å¤§z-indexå€¼ */
  position: fixed !important;
}
                </div>
            </div>
            
            <div class="fix-item">
                <div class="solution">æ–¹æ¡ˆ3: å¼ºåˆ¶æ˜¾ç¤ºæœºåˆ¶</div>
                <div class="code-block">
forceShowPopup() {
  const popup = this.$el.querySelector('.history-popup')
  if (popup) {
    const forceStyles = [
      'display: block !important',
      'opacity: 1 !important', 
      'visibility: visible !important',
      'pointer-events: auto !important',
      'z-index: 2147483647 !important'
    ]
    popup.style.cssText = forceStyles.join('; ')
  }
}
                </div>
            </div>
            
            <div class="fix-item">
                <div class="solution">æ–¹æ¡ˆ4: DOMä¿æŠ¤æœºåˆ¶</div>
                <div class="code-block">
setupDOMProtection() {
  // æ¯100msæ£€æŸ¥ä¸€æ¬¡å¼¹çª—çŠ¶æ€ï¼Œç¡®ä¿æ˜¾ç¤ºæ­£å¸¸
  this.domProtectionInterval = setInterval(() => {
    if (this.isPopupVisible) {
      const popup = this.$el?.querySelector('.history-popup')
      if (popup) {
        // æ£€æŸ¥æ˜¯å¦è¢«æ„å¤–éšè—ï¼Œå¦‚æ˜¯åˆ™å¼ºåˆ¶ä¿®å¤
        const computedStyle = getComputedStyle(popup)
        if (computedStyle.display === 'none' || 
            computedStyle.visibility === 'hidden') {
          this.forceShowPopup()
        }
      }
    }
  }, 100)
}
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª æµ‹è¯•æ­¥éª¤</h2>
            <div class="test-steps">
                <h4>è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æµ‹è¯•ä¿®å¤æ•ˆæœï¼š</h4>
                <ol>
                    <li>é‡æ–°åŠ è½½LinuxDoç½‘ç«™</li>
                    <li>ç¡®ä¿å†å²è®°å½•åŠŸèƒ½å·²å¯ç”¨ï¼ˆåœ¨æ‰©å±•è®¾ç½®ä¸­ï¼‰</li>
                    <li>ç‚¹å‡»å³ä¸‹è§’çš„å†å²è®°å½•æŒ‰é’®ï¼ˆæ—¶é’Ÿå›¾æ ‡ï¼‰</li>
                    <li><strong>é¢„æœŸç»“æœ</strong>ï¼šå¼¹çª—åº”è¯¥åœ¨å±å¹•ä¸Šå¯è§æ˜¾ç¤ºï¼Œä½ç½®å±…ä¸­æˆ–é è¿‘æŒ‰é’®</li>
                    <li>æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ç›¸å…³è°ƒè¯•ä¿¡æ¯</li>
                    <li>å°è¯•ç‚¹å‡»å¼¹çª—å¤–éƒ¨åŒºåŸŸå…³é—­å¼¹çª—</li>
                    <li>å†æ¬¡ç‚¹å‡»æŒ‰é’®ç¡®è®¤å¯ä»¥é‡å¤æ‰“å¼€</li>
                </ol>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“‹ ä¿®å¤è¯¦æƒ…</h2>
            <p><strong>ä¿®æ”¹æ–‡ä»¶ï¼š</strong> <code>entrypoints/SettingComponents/Button/HistoryBtn.vue</code></p>
            <p><strong>ä¸»è¦æ”¹åŠ¨ï¼š</strong></p>
            <ul>
                <li>é‡å†™äº† <code>toggleHistoryPopup()</code> æ–¹æ³•ï¼Œæ·»åŠ äº†å®‰å…¨çš„åˆå§‹ä½ç½®è®¾ç½®</li>
                <li>æ–°å¢ <code>forceShowPopup()</code> æ–¹æ³•ï¼Œä½¿ç”¨å†…è”æ ·å¼å¼ºåˆ¶æ˜¾ç¤º</li>
                <li>æ–°å¢ <code>updatePopupPositionSafe()</code> æ–¹æ³•ï¼Œæä¾›å®‰å…¨çš„ä½ç½®è®¡ç®—</li>
                <li>æ–°å¢ <code>setupDOMProtection()</code> æ–¹æ³•ï¼ŒæŒç»­ç›‘æ§å¼¹çª—æ˜¾ç¤ºçŠ¶æ€</li>
                <li>å¢å¼ºCSSæ ·å¼ï¼Œä½¿ç”¨æœ€é«˜ä¼˜å…ˆçº§å’Œå¤šé‡é€‰æ‹©å™¨ç¡®ä¿æ ·å¼ç”Ÿæ•ˆ</li>
                <li>ä¿®æ”¹æ¨¡æ¿ï¼Œæ·»åŠ é¢å¤–çš„CSSç±»å’Œæ ·å¼ç»‘å®š</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>ğŸ” è°ƒè¯•ä¿¡æ¯</h2>
            <p>ä¿®å¤åçš„ç‰ˆæœ¬ä¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼š</p>
            <div class="code-block">
History button clicked!
Popup visibility changed to: true
Opening popup, loading history...
Button position: {left: 1142.75, top: 844.25, ...}
Safe popup position calculated: {left: 640, top: 290}
Force show popup result: {visible: true, display: "block", ...}
            </div>
            <p>å¦‚æœä»æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥è¿™äº›è°ƒè¯•ä¿¡æ¯ä»¥ç¡®å®šå…·ä½“åŸå› ã€‚</p>
        </div>
        
        <div class="fix-summary" style="background: #cce5ff; border-color: #007bff;">
            <h3>ğŸ’¡ æŠ€æœ¯æ€»ç»“</h3>
            <p>æœ¬æ¬¡ä¿®å¤é‡‡ç”¨äº†<strong>é˜²å¾¡æ€§ç¼–ç¨‹</strong>çš„æ€è·¯ï¼Œé€šè¿‡å¤šé‡ä¿éšœæœºåˆ¶ç¡®ä¿åŠŸèƒ½çš„å¥å£®æ€§ï¼š</p>
            <ul>
                <li>âœ… <strong>ä½ç½®è®¡ç®—</strong>ï¼šä¼˜å…ˆä¸­å¿ƒä½ç½®ï¼Œé¿å…è¶…å‡ºè§†çª—</li>
                <li>âœ… <strong>æ ·å¼ä¿æŠ¤</strong>ï¼šä½¿ç”¨æœ€é«˜ä¼˜å…ˆçº§CSSï¼Œé˜²æ­¢è¢«è¦†ç›–</li>
                <li>âœ… <strong>å¼ºåˆ¶æ˜¾ç¤º</strong>ï¼šç›´æ¥æ“ä½œDOMæ ·å¼ï¼Œç»•è¿‡æ¡†æ¶é™åˆ¶</li>
                <li>âœ… <strong>æŒç»­ç›‘æ§</strong>ï¼šå®šæ—¶æ£€æŸ¥æ˜¾ç¤ºçŠ¶æ€ï¼Œè‡ªåŠ¨ä¿®å¤å¼‚å¸¸</li>
                <li>âœ… <strong>å…¼å®¹æ€§ä¿éšœ</strong>ï¼šä¿ç•™åŸæœ‰æ¥å£ï¼Œå‘åå…¼å®¹</li>
            </ul>
        </div>
    </div>
</body>
</html>